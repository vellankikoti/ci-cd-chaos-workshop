# ðŸ’€ BROKEN SECRET CONFIGURATIONS
# Examples of how NOT to handle secrets

apiVersion: v1
kind: Namespace
metadata:
  name: broken-secrets-demo

---
# ðŸ’€ MISTAKE 1: Secrets in ConfigMaps (not encrypted!)
apiVersion: v1
kind: ConfigMap
metadata:
  name: database-config
  namespace: broken-secrets-demo
data:
  host: "mysql-service"
  username: "root"
  password: "supersecret123"  # ðŸ˜± PASSWORD IN CONFIGMAP!
  api_key: "sk-1234567890abcdef"  # ðŸ’€ API KEY EXPOSED!

---
# ðŸ’€ MISTAKE 2: Wrong secret type
apiVersion: v1
kind: Secret
metadata:
  name: broken-tls-secret
  namespace: broken-secrets-demo
type: Opaque  # ðŸ’€ SHOULD BE kubernetes.io/tls
data:
  tls.crt: <certificate-data>
  tls.key: <private-key-data>

---
# ðŸ’€ MISTAKE 3: Hardcoded secrets in deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: broken-app
  namespace: broken-secrets-demo
spec:
  replicas: 1
  selector:
    matchLabels:
      app: broken-app
  template:
    metadata:
      labels:
        app: broken-app
    spec:
      containers:
      - name: app
        image: nginx
        env:
        - name: DB_PASSWORD
          value: "hardcoded-password-123"  # ðŸ’€ NEVER DO THIS!
        - name: API_SECRET
          value: "another-hardcoded-secret"  # ðŸ˜± VISIBLE IN YAML!

---
# ðŸ’€ MISTAKE 4: Over-permissive secret access
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: secret-reader
  namespace: broken-secrets-demo
rules:
- apiGroups: [""]
  resources: ["secrets"]
  verbs: ["*"]  # ðŸ’€ ALL PERMISSIONS ON ALL SECRETS!

---
# ðŸ’€ MISTAKE 5: Secret mounted as environment variable (visible in ps)
apiVersion: v1
kind: Pod
metadata:
  name: insecure-pod
  namespace: broken-secrets-demo
spec:
  containers:
  - name: app
    image: busybox
    command: ["sleep", "3600"]
    env:
    - name: SECRET_TOKEN
      valueFrom:
        secretKeyRef:
          name: api-secret
          key: token  # ðŸ’€ SECRET VISIBLE IN PROCESS LIST!

---
# ðŸ’€ MISTAKE 6: No secret rotation policy
apiVersion: v1
kind: Secret
metadata:
  name: stale-secret
  namespace: broken-secrets-demo
  annotations:
    created: "2020-01-01"  # ðŸ˜± 4+ YEARS OLD!
    last-rotated: "never"  # ðŸ’€ NEVER CHANGED!
type: Opaque
data:
  password: b2xkLXBhc3N3b3Jk  # old-password